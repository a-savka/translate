var app=angular.module("translator",["ngAnimate","ui.bootstrap"]);angular.bootstrap().invoke(["$http",function(n){n.get("/api/translations/config").success(function(n,t,e){angular.module("translator").constant("conf",n),angular.bootstrap(document.getElementById("translatorApp"),["translator"])})}]),app.controller("MainCtrl",["$scope","$rootScope","conf","loadingService","translationService","modalService",function(n,t,e,a,o,r){n.loading=!1,n.translating=!1,n.source={text:""},t.$on("httpnotify:anyaction",function(){n.loading=a.isUrlPendingRE("/api/translations/latest"),n.translating=a.isUrlPendingRE("/api/translations/translate")}),n.loadTranslations=function(){o.loadTranslations()},n.getTranslateIconClass=function(){return n.translating?"fa fa-spin fa-spinner":"fa fa-book"},n.canLoadMore=function(){return!n.loading&&o.hasMore()},n.getTranslations=function(){return o.getTranslations()},n.translate=function(){o.translate(n.source.text).then(function(){n.source.text=""})["catch"](function(n){r.alert("Translation failed",n)})},n.canTranslate=function(){return!n.translating},o.loadTranslations()}]),function(n){n.factory("loadingService",["$http",function(n){var t={};return t.isUrlPending=function(t){return n.pendingRequests.some(function(n){return t.toLowerCase()==n.url.toLowerCase()})},t.isUrlPendingRE=function(t){return n.pendingRequests.some(function(n){var e=new RegExp("^"+t.toLowerCase()+".*$");return e.test(n.url.toLowerCase())})},t}]),n.config(["$httpProvider",function(n){n.interceptors.push(["$rootScope","$q","$timeout",function(n,t,e){function a(){e(function(){n.$broadcast("httpnotify:anyaction")},0)}return{request:function(n){return a(),n},response:function(n){return a(),n},requestError:function(n){return a(),t.reject(n)},responseError:function(n){return a(),t.reject(n)}}}])}])}(app),function(){angular.module("translator").factory("translationService",["$http","conf","$q",function(n,t,e){function a(){return f}function o(){return d}function r(n){for(var t=-1,e=0;e<f.length;e++)if(f[e]._id===n){t=e;break}return t}function i(n,t){var e=r(n);-1!=e&&(f[e].pendingRequest=t)}function s(n){var t=r(n);return-1!=t&&f[t].pendingRequest}function l(){if(!d)return e.reject("There are no more translations");var a="/api/translations/latest";return f.length>0&&(a+="?id="+f[f.length-1]._id),n.get(a).then(function(n){return n.data.length<=t.latestTranslationsCount&&(d=!1),f=f.concat(n.data.slice(0,t.latestTranslationsCount))})}function c(t){return s(t)?e.reject("Pending request"):(i(t,!0),n["delete"]("/api/translations/"+t).then(function(n){var a=r(t);return"ok"==n.data.message?(f.splice(a,1),"ok"):e.reject(n.data.message)})["finally"](function(){i(t,!1)}))}function u(t){return""===t?e.reject("Text to translate wasn't provided"):n.post("/api/translations/translate",{text:t}).then(function(n){return 200==n.status?(f.unshift(n.data),f):e.reject(n.data.message)})}var f=[],d=!0;return{hasMore:o,getTranslations:a,loadTranslations:l,deleteTranslation:c,translate:u}}])}(),function(){angular.module("translator").factory("modalService",["$uibModal",function(n){function t(t,e){return modalInstance=n.open({animation:!0,size:"xs",template:"<div class='modal-header'>  <h4 class='modal-title warning'><i class='fa fa-warning'></i>&nbsp;<span ng-bind='title'></span></h4></div><div class='modal-body'>  <p ng-bind='message'></p></div><div class='modal-footer'>  <button class='btn btn-primary' type='button' ng-click='ok()'>Close</button></div>",controller:["$scope","$uibModalInstance","message","title",function(n,t,e,a){n.message=e,n.title=a,n.ok=function(){t.dismiss("cancel")}}],resolve:{message:function(){return e},title:function(){return t}}})}function e(t,e,a,o){return a=a||"Yes",o=o||"No",modalInstance=n.open({animation:!0,size:"xs",template:"<div class='modal-header'>  <h4 class='modal-title warning'><i class='fa fa-warning'></i>&nbsp;<span ng-bind='title'></span></h4></div><div class='modal-body'>  <p ng-bind='message'></p></div><div class='modal-footer'>  <button class='btn btn-primary' type='button' ng-click='ok()'><span ng-bind='yesBtnCaption'></span></button>  <button class='btn btn-warning' type='button' ng-click='cancel()'><span ng-bind='noBtnCaption'></span></button></div>",controller:["$scope","$uibModalInstance","message","title","yesBtnCaption","noBtnCaption",function(n,t,e,a,o,r){n.message=e,n.title=a,n.yesBtnCaption=o,n.noBtnCaption=r,n.ok=function(){t.close("ok")},n.cancel=function(){t.dismiss("cancel")}}],resolve:{message:function(){return e},title:function(){return t},yesBtnCaption:function(){return a},noBtnCaption:function(){return o}}})}return{alert:t,confirm:e}}])}(),function(){var n=angular.module("translator");n.directive("translationItem",["translationService","modalService",function(n,t){return{restrict:"A",replace:!0,scope:{translation:"="},templateUrl:"tplTranslationItem",controller:["$scope",function(e){e.getRemoveButtonIconClass=function(n){return n.pendingRequest?"fa fa-spin fa-spinner":"fa fa-remove"},e.deleteTranslation=function(e){t.confirm("Please Confirm","Are you sure to delete this record?").result.then(function(){return n.deleteTranslation(e)})}}]}}])}();